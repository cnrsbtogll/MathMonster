{% extends "base.html" %}

{% block content %}
<script>
// Oyun bitince ses efekti
window.onload = function() {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    // Dramatik ses efekti
    const playDramaticSound = () => {
        const frequencies = [150, 120, 100, 80];
        frequencies.forEach((freq, index) => {
            setTimeout(() => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }, index * 200);
        });
    };
    
    playDramaticSound();
};
</script>
<div class="math-monster">ğŸ‘¹</div>

<div class="emoji-border">ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥</div>

<h1>ğŸ® MATEMATÄ°K CANAVARI KAZANDI! ğŸ®</h1>

<div class="emoji-border">ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥ğŸ’¥</div>

<div style="font-size: 1.2em; margin: 20px 0; font-style: italic;">
    ğŸ‘¹ "Hehe! Bu sefer ben kazandÄ±m! Ama Ã§ok iyi mÃ¼cadele ettin!" ğŸ‘¹
</div>

<div class="game-over">
    <p style="font-size: 1.3em; margin-bottom: 20px;">
        ğŸ˜” Maalesef yanlÄ±ÅŸ cevap verdin...
    </p>
    
    <div class="emoji-border">ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†</div>
    
    <div class="final-score">
        ğŸŠ {{ final_skor }} ğŸŠ
    </div>
    
    <p style="font-size: 1.1em; margin-bottom: 20px;">FINAL SKOR</p>
    
    <div class="emoji-border">ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†</div>
</div>

<div style="margin: 30px 0; font-size: 1.2em;">
    <p style="margin-bottom: 15px;">ğŸ­ {{ player_name }} iÃ§in sonuÃ§lar:</p>
    
    {% if final_skor == 0 %}
        ğŸŒ± BaÅŸlangÄ±Ã§ gÃ¼zel! Bir daha dene! ğŸ’ª
    {% elif final_skor <= 5 %}
        ğŸŒŸ Ä°yi bir baÅŸlangÄ±Ã§! Daha da iyisini yapabilirsin! ğŸš€
    {% elif final_skor <= 10 %}
        âœ¨ Harika! Sen gerÃ§ek bir matematik yÄ±ldÄ±zÄ±sÄ±n! â­
    {% elif final_skor <= 20 %}
        ğŸ”¥ Ä°nanÄ±lmaz! Sen bir matematik dÃ¢hisisin! ğŸ§ 
    {% else %}
        ğŸ‘‘ EFSANE! Sen matematik kralÄ±sÄ±n! ğŸ¦„
    {% endif %}
</div>

{% if player_stats %}
<div class="rules">
    <h3 style="text-align: center; margin-bottom: 20px;">ğŸ“ˆ KiÅŸisel Ä°statistiklerin</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
        <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <div style="font-size: 1.5em; font-weight: bold; color: #f39c12;">{{ player_stats.best_score }}</div>
            <div style="font-size: 0.9em;">ğŸ† En Ä°yi Skor</div>
        </div>
        <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <div style="font-size: 1.5em; font-weight: bold; color: #27ae60;">{{ player_stats.total_games_played }}</div>
            <div style="font-size: 0.9em;">ğŸ® Toplam Oyun</div>
        </div>
        <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <div style="font-size: 1.5em; font-weight: bold; color: #3498db;">%{{ player_stats.calculate_accuracy() }}</div>
            <div style="font-size: 0.9em;">ğŸ¯ DoÄŸruluk</div>
        </div>
        <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <div style="font-size: 1.5em; font-weight: bold; color: #9b59b6;">{{ player_stats.highest_level_reached }}</div>
            <div style="font-size: 0.9em;">ğŸŒŸ En YÃ¼ksek Seviye</div>
        </div>
    </div>
</div>
{% endif %}

<div style="margin: 40px 0;">
    <form action="{{ url_for('yeniden_oyna') }}" method="POST" style="display: inline;">
        <button type="submit" class="btn btn-success">
            ğŸ”„ YENÄ°DEN OYNA! ğŸ”„
        </button>
    </form>
    
    <a href="{{ url_for('ana_sayfa') }}" class="btn" style="background: linear-gradient(45deg, #95a5a6, #7f8c8d);">
        ğŸ  Ana Sayfa
    </a>
</div>

<div style="margin-top: 30px; font-size: 0.9em; opacity: 0.8;">
    ğŸŒˆ TeÅŸekkÃ¼rler! Tekrar gÃ¶rÃ¼ÅŸmek Ã¼zere! ğŸŒˆ
</div>
{% endblock %}